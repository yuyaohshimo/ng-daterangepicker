/*!
 * ng-daterangepicker.js
 * https://github.com/yuyaohshimo/ng-daterangepicker
 *
 * Copyright (c) 2014 Yuya Ohshimo
 * Licensed under the MIT license.
 */
(function(){angular.module("dateRangePicker",[]),angular.module("dateRangePicker").directive("dateRangePicker",["$window",function(e){return{restrict:"AE",replace:!0,template:'<div ng-click="$event.stopPropagation()" class="daterangepicker"><div class="daterangepicker__option"><select ng-model="selectedOption" ng-options="option.label for option in options" ng-change="onChangeSelect()" ng-click="onClickSelect()"></select></div><div ng-show="selectedOption.value === \'custom\'" class="daterangepicker__cutom"><div class="daterangepicker__start"><input ng-if="isMobile" type="date" ng-model="start.value._d" class="daterangepicker__input"/><input ng-if="!isMobile" type="text" ng-model="start.value" ng-click="toggleDropdown(\'start\')" readonly="" class="daterangepicker__input"/><div ng-show="start.show" ng-if="!isMobile" class="daterangepicker__dropdown"><button ng-click="onChangeMonth(\'start\', -1)" class="daterangepicker__prev">&lt;</button><button ng-click="onChangeMonth(\'start\', 1)" ng-if="start.month &lt; end.month" class="daterangepicker__next">&gt;</button><div class="daterangepicker__calendars"><h4 class="daterangepicker__year">{{ _moment.clone().month(start.month).format(locale.year || \'YYYY\') }}</h4><h4 class="daterangepicker__month">{{ _moment.clone().month(start.month).format(\'MMMM\') }}</h4><table><thead><tr><th ng-repeat="week in weeks">{{ week }}</th></tr></thead><tbody><tr ng-repeat="week in start.days"><td ng-repeat="day in week" ng-class="{ disabled: day.disabled, selected: !day.disabled &amp;&amp; (start.value.month() === _moment.clone().month(start.month).month()) &amp;&amp; (day.value == start.value.format(\'D\')) }" ng-click="onSelectDay(\'start\', day, day.value, end.value.format(\'D\'))">{{ day.value }}</td></tr></tbody></table></div></div></div><div ng-bind="format.to" class="daterangepicker__to"></div><div class="daterangepicker__end"><input ng-if="isMobile" type="date" ng-model="end.value._d" class="daterangepicker__input"/><input ng-if="!isMobile" type="text" ng-model="end.value" ng-click="toggleDropdown(\'end\')" readonly="" class="daterangepicker__input"/><div ng-show="end.show" ng-if="!isMobile" class="daterangepicker__dropdown"><button ng-click="onChangeMonth(\'end\', -1)" ng-if="start.month &lt; end.month" class="daterangepicker__prev">&lt;</button><button ng-click="onChangeMonth(\'end\', 1)" class="daterangepicker__next">&gt;</button><div class="daterangepicker__calendars"><h4 class="daterangepicker__year">{{ _moment.clone().month(end.month).format(locale.year || \'YYYY\') }}</h4><h4 class="daterangepicker__month">{{ _moment.clone().month(end.month).format(\'MMMM\') }}</h4><table><thead><tr><th ng-repeat="week in weeks">{{ week }}</th></tr></thead><tbody><tr ng-repeat="week in end.days"><td ng-repeat="day in week" ng-class="{ disabled: day.disabled, selected: !day.disabled &amp;&amp; (end.value.month() === _moment.clone().month(end.month).month()) &amp;&amp; (day.value == end.value.format(\'D\')) }" ng-click="onSelectDay(\'end\', day, start.value.format(\'D\'), day.value)">{{ day.value }}</td></tr></tbody></table></div></div></div></div></div>',scope:{isMobile:"=",options:"=",initialRange:"=",locale:"=",rangeOptions:"=",format:"=",applyDateRange:"&"},link:function(t){function n(e){var n=t.start,a=t.end;e&&(n=null,a=null),t.applyDateRange({start:n,end:a})}function a(e,n){return moment().clone().month(t.start.month).day(e)<=moment().clone().month(t.end.month).day(n)}function o(e){return"start"===e?"end":"start"}function d(e){for(var t=7,n=[],a=0;a<Math.ceil(e.length/t);a++){var o=a*t;n.push(e.slice(o,o+t))}return n}function l(e){for(var n=t[e].month,a=moment().month(n).startOf("month").day(),o=moment().month(n).endOf("month").date(),d=6-moment().month(n).endOf("month").day(),l=moment().month(n-1).endOf("month").format("D"),i=[];a>0;)i.push({value:l-a+1,disabled:!0}),a--;for(var s=1;o>=s;s++)i.push({value:s,disabled:!1});for(var r=1;d>=r;r++)i.push({value:r,disabled:!0});return i}t.locale&&moment.locale("dateRangePicker",{months:t.locale.months||moment.months(),weekdaysShort:t.locale.weekdaysShort||moment.weekdaysShort()}),angular.element(e).bind("click",function(){(t.start.show||t.end.show)&&(t.start.show=t.end.show=!1,t.$apply())}),t._moment=moment(),t.start={value:t.initialRange.start||moment(),month:t.initialRange.start?t.initialRange.start.month():month(),show:!1},t.end={value:t.initialRange.end||moment(),month:t.initialRange.end?t.initialRange.end.month():month(),show:!1},t.start.days=d(l("start")),t.end.days=d(l("end")),t.selectedOption=t.options[0],t.weeks=moment.weekdaysShort(),t.onClickSelect=function(){t.start.show=t.end.show=!1},t.onChangeSelect=function(){if("custom"!==t.selectedOption.value){if("all"===t.selectedOption.value)return n(!0);t.start.value=t.selectedOption.start,t.start.month=t.start.value.month(),t.start.days=d(l("start")),t.end.value=t.selectedOption.end,t.end.month=t.end.value.month(),t.end.days=d(l("end")),n()}},t.onSelectDay=function(e,o,d,l){if(!o.disabled&&a(d,l)){var i=t[e].month;t[e].value=moment().month(i).date(o.value),t[e].show=!1,n()}},t.onChangeMonth=function(e,n){t[e].month+=n,t[e].days=d(l(e))},t.toggleDropdown=function(e){t[o(e)].show=!1,t[e].show=!t[e].show}}}}])}).call(this);